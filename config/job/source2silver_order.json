{
    "job_id": "source2silver_order",
    "schedule": "",
    "depend_on": "",
    "run_mode": {
      "name": "default"
    },
    "extract": {
        "customers": {
            "url": "jdbc:postgresql://postgres-metastore:5432/retail",
            "properties": {
                "user": "etl",
                "password": "etl",
                "driver": "org.postgresql.Driver"
            },
            "reader": "JDBCReader",
            "query": "SELECT * FROM \"order\" WHERE updated_at >= (CURRENT_DATE - INTERVAL '1 day') AND created_at < CURRENT_DATE"
        }
    },
    "transform": {
        "transformer": "ConfigTransformer",
        "transformation": {
          "customers": [
            {
              "op": "withColumn",
              "args": {
                "colName": "partition_date",
                "col": "F.to_date(F.col('updated_at'))"
              }
            }
          ]
        }
    },
    "load": {
        "customers": {
            "table_name": "iceberg.silver.order",
            "writer": "IcebergWriter",
            "mode": "append",
            "format": "parquet",
            "partition_by": [
                "partition_date"
            ],
            "path": "s3a://warehouse/silver/order"
        }
    }
}