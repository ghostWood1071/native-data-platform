{
    "job_id": "bronze2silver_T_MARGIN_EXTRA_BALANCE_HIS",
    "schedule": "",
    "depend_on": ["source2bronze_T_MARGIN_EXTRA_BALANCE_HIS"],
    "run_mode": {
        "name": "default"
    },
    "extract": {
        "T_MARGIN_EXTRA_BALANCE_HIS": {
            "query": "SELECT * FROM bronze.daily_load_T_MARGIN_EXTRA_BALANCE_HIS WHERE CAST(etl_date AS DATE) = CAST(current_timestamp() + INTERVAL 7 HOURS AS DATE)",
            "reader": "DeltaReader"
        }
    },
    "transform": {
        "transformer": "ConfigTransformer",
        "transformation": {
            "T_MARGIN_EXTRA_BALANCE_HIS": [
                {
                    "op": "drop",
                    "args": {
                        "cols": ["etl_date"]
                    }
                }
            ]
        }
    },
    "load": {
        "T_MARGIN_EXTRA_BALANCE_HIS": {
            "table_name": "spark_catalog.silver.T_MARGIN_EXTRA_BALANCE_HIS",
            "writer": "DeltaWriter",
            "mode": "overwrite",
            "format": "delta",
            "partition_by": [
                "partition_date"
            ],
            "path": "s3a://warehouse/silver/T_MARGIN_EXTRA_BALANCE_HIS"
        }
    }
}